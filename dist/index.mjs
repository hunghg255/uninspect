const b={clear:!0,debug:!0,debugTime:3e3,bfcache:!0},s={Chrome:0,Firefox:1,Safari:2},u=t=>t?t[0]!=="/"?`/${t}`:t:"/",a=t=>~navigator.userAgent.toLowerCase().indexOf(t),w=t=>typeof t=="string",l=(t,e)=>{if(e===s.Safari){location.replace(t);return}location.href=t};let _=0,o=0;const n=t=>{let e=0;const i=1<<_++;return()=>{o&&!(o&i)||(e++,e===2&&(o|=i,t(),e=1))}},m=t=>{const e=new Error;Object.defineProperty(e,"message",{get(){t()}}),console.log(e)},p=t=>{const e=/./;e.toString=n(t);const i=()=>e;i.toString=n(t);const r=new Date;r.toString=n(t),console.log("%c",i,i(),r);const c=n(t);m(c)},T=t=>{const e=/./;e.toString=t,console.log(e)},S=t=>{const e=new Image;Object.defineProperty(e,"id",{get:()=>{t(s.Safari)}}),console.log(e)};class k{constructor(e){const{clear:i,debug:r,debugTime:c,callback:h,redirect:d,write:g,bfcache:f}={...b,...e};this._debug=r,this._debugTime=c,this._clear=i,this._bfcache=f,this._callback=h,this._redirect=d,this._write=g}clear(){this._clear&&(console.clear=()=>{})}bfcache(){this._bfcache&&(window.addEventListener("unload",()=>{}),window.addEventListener("beforeunload",()=>{}))}debug(){if(this._debug){const e=new Function("debugger");setInterval(e,this._debugTime)}}redirect(e){const i=this._redirect;if(!i)return;if(i.indexOf("http")===0){location.href!==i&&l(i,e);return}const r=location.pathname+location.search;u(i)!==r&&l(i,e)}callback(){if(!this._callback&&!this._redirect&&!this._write||!window)return;const e=this.fire.bind(this),i=window.chrome||a("chrome"),r=a("firefox");if(i){p(e);return}if(r){T(e);return}S(e)}write(){const e=this._write;e&&(document.body.innerHTML=w(e)?e:e.innerHTML)}fire(e){if(this._callback){this._callback.call(null);return}this.redirect(e),!this._redirect&&this.write()}prepare(){this.clear(),this.bfcache(),this.debug()}ban(){this.prepare(),this.callback()}}const C=t=>{new k(t).ban()};export{C as init};
